{"ast":null,"code":"// Simple API helper: uses stored token if present, but falls back gracefully to localStorage-only flow.\n\nexport function getAuthToken() {\n  try {\n    const s = localStorage.getItem('currentUser');\n    if (!s) return null;\n    const obj = JSON.parse(s);\n    return (obj === null || obj === void 0 ? void 0 : obj.token) || null;\n  } catch (e) {\n    return null;\n  }\n}\nasync function apiFetch(path, options = {}) {\n  const base = process.env.REACT_APP_API_BASE || '';\n  const url = base + path;\n  const token = getAuthToken();\n  const headers = options.headers || {};\n  if (token) headers['Authorization'] = `Bearer ${token}`;\n  if (!(options.body instanceof FormData) && !headers['Content-Type']) {\n    headers['Content-Type'] = 'application/json';\n  }\n  try {\n    const res = await fetch(url, {\n      ...options,\n      headers\n    });\n    if (!res.ok) {\n      const body = await res.json().catch(() => ({}));\n      const err = new Error(body.message || 'API error');\n      err.status = res.status;\n      err.body = body;\n      throw err;\n    }\n    return await res.json().catch(() => ({}));\n  } catch (err) {\n    // propagate error to caller; caller can fallback to localStorage\n    throw err;\n  }\n}\nexport async function fetchEntriesFromBackend() {\n  return apiFetch('/api/data');\n}\nexport async function createEntryOnBackend(entry) {\n  return apiFetch('/api/data', {\n    method: 'POST',\n    body: JSON.stringify(entry)\n  });\n}\nexport async function deleteEntryOnBackend(id) {\n  return apiFetch(`/api/data/${id}`, {\n    method: 'DELETE'\n  });\n}\nexport async function changePasswordApi({\n  currentPassword,\n  newPassword\n}) {\n  return apiFetch('/api/auth/change-password', {\n    method: 'POST',\n    body: JSON.stringify({\n      currentPassword,\n      newPassword\n    })\n  });\n}\nexport async function updateProfileApi(updates) {\n  return apiFetch('/api/auth/update-profile', {\n    method: 'POST',\n    body: JSON.stringify(updates)\n  });\n}","map":{"version":3,"names":["getAuthToken","s","localStorage","getItem","obj","JSON","parse","token","e","apiFetch","path","options","base","process","env","REACT_APP_API_BASE","url","headers","body","FormData","res","fetch","ok","json","catch","err","Error","message","status","fetchEntriesFromBackend","createEntryOnBackend","entry","method","stringify","deleteEntryOnBackend","id","changePasswordApi","currentPassword","newPassword","updateProfileApi","updates"],"sources":["C:/Users/SUGMYA/OneDrive/Desktop/finarth-main - Copy/frontend/src/utils/api.js"],"sourcesContent":["// Simple API helper: uses stored token if present, but falls back gracefully to localStorage-only flow.\r\n\r\nexport function getAuthToken() {\r\n  try {\r\n    const s = localStorage.getItem('currentUser');\r\n    if (!s) return null;\r\n    const obj = JSON.parse(s);\r\n    return obj?.token || null;\r\n  } catch (e) { return null; }\r\n}\r\n\r\nasync function apiFetch(path, options = {}) {\r\n  const base = process.env.REACT_APP_API_BASE || '';\r\n  const url = base + path;\r\n  const token = getAuthToken();\r\n  const headers = options.headers || {};\r\n  if (token) headers['Authorization'] = `Bearer ${token}`;\r\n  if (!(options.body instanceof FormData) && !headers['Content-Type']) {\r\n    headers['Content-Type'] = 'application/json';\r\n  }\r\n  try {\r\n    const res = await fetch(url, { ...options, headers });\r\n    if (!res.ok) {\r\n      const body = await res.json().catch(() => ({}));\r\n      const err = new Error(body.message || 'API error');\r\n      err.status = res.status;\r\n      err.body = body;\r\n      throw err;\r\n    }\r\n    return await res.json().catch(() => ({}));\r\n  } catch (err) {\r\n    // propagate error to caller; caller can fallback to localStorage\r\n    throw err;\r\n  }\r\n}\r\n\r\nexport async function fetchEntriesFromBackend() {\r\n  return apiFetch('/api/data');\r\n}\r\n\r\nexport async function createEntryOnBackend(entry) {\r\n  return apiFetch('/api/data', { method: 'POST', body: JSON.stringify(entry) });\r\n}\r\n\r\nexport async function deleteEntryOnBackend(id) {\r\n  return apiFetch(`/api/data/${id}`, { method: 'DELETE' });\r\n}\r\n\r\nexport async function changePasswordApi({ currentPassword, newPassword }) {\r\n  return apiFetch('/api/auth/change-password', { method: 'POST', body: JSON.stringify({ currentPassword, newPassword }) });\r\n}\r\n\r\nexport async function updateProfileApi(updates) {\r\n  return apiFetch('/api/auth/update-profile', { method: 'POST', body: JSON.stringify(updates) });\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}